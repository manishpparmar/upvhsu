$(document).ready(function(){function e(){$.post("/totalnumberofdentalpatients",{},function(e,t,a){e&&Highcharts.chart("dentistcontainer",{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:"Finished vs. Unfinished Appointments"},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {y}",style:{color:Highcharts.theme&&Highcharts.theme.contrastTextColor||"black"}}}},series:[{name:"Appointments",colorByPoint:!0,data:[{name:"Finished",y:e.finished,sliced:!1,selected:!0},{name:"Unfinished",y:e.unfinished}]}]})})}function t(e){return e%4==0&&e%100!=0||e%400==0}1==$("#dentistdashboard").val()&&e(),$("#staffnotesdentist").keyup(function(){$("#savingstatus").html("Saving..."),$.post("/dentist/updatestaffnotes",{note:$("#staffnotesdentist").val()},function(e,t,a){$("#savingstatus").html("&nbsp;")})}),$(".dental_chart").click(function(){var e=$(this).attr("id").split("_");teethId=e[1],$.ajax({type:"POST",url:updateDentalRecordModal,data:{teeth_id:teethId,_token:token},success:function(e){null!=e.condition_id?$(".condition").val(e.condition_id):$(".condition").val(0),null!=e.operation_id?$(".operation").val(e.operation_id):$(".operation").val(0)}}),window.setTimeout(function(){$("#update-dental-record-modal").modal("show")},5e3)});var a,n=1e3;$(".dental_chart").hover(function(){var e=$(this).attr("id").split("_"),t=e[0],i=$(this).attr("operation_id"),d=$(this).attr("condition_id");a=setTimeout(function(){"operation"==t?$("#operation_"+i).effect("pulsate",{times:1},1e3):$("#condition_"+d).effect("pulsate",{times:1},1e3)},n)},function(){clearTimeout(a)}),$(".updateDentalRecord").click(function(){if($(".condition").val()||$(".operation").val()){var e=$(this).attr("id").split("_");appointmentId=e[1];var t=$(".condition").val(),a=$(".operation").val();null==a&&(a=0),null==t&&(t=0),$.ajax({type:"POST",url:insertDentalRecordModal,data:{teeth_id:teethId,condition_id:t,operation_id:a,appointment_id:appointmentId,_token:token},success:function(e){$("#condition_"+teethId).attr("condition_id",t),1==t?$("#condition_"+teethId).css({fill:"#ff4000"}):2==t?$("#condition_"+teethId).css({fill:"#ffff00"}):3==t?$("#condition_"+teethId).css({fill:"#00ff00"}):4==t?$("#condition_"+teethId).css({fill:"#00ffff"}):5==t?$("#condition_"+teethId).css({fill:"#0000ff"}):$("#condition_"+teethId).css({fill:"white"}),$("#operation_"+teethId).attr("operation_id",a),1==a?$("#operation_"+teethId).css({fill:"#bf00ff"}):2==a?$("#operation_"+teethId).css({fill:"#ff0080"}):3==a?$("#operation_"+teethId).css({fill:"#ff0000"}):4==a?$("#operation_"+teethId).css({fill:"#808080"}):5==a?$("#operation_"+teethId).css({fill:"#194d19"}):$("#operation_"+teethId).css({fill:"white"}),$("#update-dental-record-modal").modal("hide")}})}}),$(".updateDentalDiagnosis").click(function(){var e=$(this).attr("id").split("_");appointmentId=e[1],$.ajax({type:"POST",url:updateDentalDiagnosis,data:{appointment_id:appointmentId,_token:token},success:function(e){setTimeout(function(){window.location.href="http://localhost:8000/dentist"},5e3)}})}),$(".addedDentalRecord").click(function(){$("#confirm_additional_dental_record").modal("show")}),counter=0,$(".additionaldentalrecordforms").change(function(){counter++;var e=18;counter>6?$("#teethPresent").val()?($("#teethPresent").val()>=0&&$("#teethPresent").val()<=e&&$("#teethPresent").val()&&$(".addedDentalRecord").removeAttr("disabled"),$("#teethPresent").keyup(function(){$("#teethPresent").val()>=0&&$("#teethPresent").val()<=e&&$("#teethPresent").val()?$(".addedDentalRecord").removeAttr("disabled"):$(".addedDentalRecord").attr("disabled","disabled")})):$("#teethPresent").keyup(function(){$("#teethPresent").val()>=0&&$("#teethPresent").val()<=e&&$("#teethPresent").val()?$(".addedDentalRecord").removeAttr("disabled"):$(".addedDentalRecord").attr("disabled","disabled")}):$(".addedDentalRecord").attr("disabled","disabled")}),$(".confirmAdditionalDentalRecord").click(function(){var e=$(this).attr("id").split("_");appointmentId=e[1];var t=$("#selDentalCaries").find(":selected")[0].value,a=$("#selGingivitis").find(":selected")[0].value,n=$("#selPeridontalPocket").find(":selected")[0].value,i=$("#selOralDebris").find(":selected")[0].value,d=$("#selCalculus").find(":selected")[0].value,o=$("#selNeoplasm").find(":selected")[0].value,l=$("#selDentalFacioAnomaly").find(":selected")[0].value,r=$("#teethPresent").val();dental_services_id=[],$("input:checkbox.checkboxDentalService").each(function(){$(this).is(":checked")&&dental_services_id.push($(this).attr("id"))}),t&&a&&n&&i&&d&&o&&l&&r?$.ajax({type:"POST",url:additionalDentalRecord,data:{appointment_id:appointmentId,dental_caries:t,gingivitis:a,peridontal_pocket:n,oral_debris:i,calculus:d,neoplasm:o,dental_facio_anomaly:l,teeth_present:r,dental_services_id:dental_services_id,_token:token},success:function(e){return $("#confirm_additional_dental_record").modal("hide"),$("#selDentalCaries").attr("disabled","disabled"),$("#selGingivitis").attr("disabled","disabled"),$("#selPeridontalPocket").attr("disabled","disabled"),$("#selOralDebris").attr("disabled","disabled"),$("#selCalculus").attr("disabled","disabled"),$("#selNeoplasm").attr("disabled","disabled"),$("#selDentalFacioAnomaly").attr("disabled","disabled"),$("#teethPresent").attr("disabled","disabled"),$("#additionalDentalRecordInput").attr("disabled","disabled"),$(".addedDentalRecord").attr("disabled","disabled"),$("#confirm_additional_dental_record").modal("hide"),$("#additionalDentalRecordPanelBody").css("background-color","#d6e9c6"),window.location.href="http://upvhsu.pe.hu/dentist",!1}}):$("#confirm_additional_dental_record").modal("hide")});var i=0;$(".checkboxDentalService").click(function(){$(this).is(":checked")?i++:i--,i>0?($(".additionaldentalrecordforms").removeAttr("disabled"),$("#teethPresent").removeAttr("disabled")):($(".additionaldentalrecordforms").attr("disabled","disabled"),$("#teethPresent").attr("disabled","disabled"),$(".additionaldentalrecordforms").val($(".additionaldentalrecordforms option:first").val()),$("#teethPresent").val(""))}),$(".addmoredentalsched").click(function(){$(this).parents(".dental_manage").find("tbody").append('<tr class="schedule_tr"><td><input type="date" class="form-control"/></td><td><input type="time" class="form-control starthour"/></td><td><input type="time" class="form-control endhour"/></td><td><button class="btn btn-danger btn-sm removedentalsched">Remove</button></td></tr>'),$(".removedentalsched").click(function(){$(this).closest("tr").remove()})}),$(".removedentalsched").click(function(){$(this).closest("tr").remove()}),$("#adddentalschedule").click(function(){var e=[];$(".schedule_tr").each(function(){$(this).find('input[type="date"]').val()&&$(this).find(".starthour").val()&&$(this).find(".endhour").val()&&e.push($(this).find('input[type="date"]').val()+" "+$(this).find(".starthour").val()+":00;;;"+$(this).find('input[type="date"]').val()+" "+$(this).find(".endhour").val()+":00")}),e.length>0&&$.ajax({url:addDentalSchedule,type:"POST",dataType:"json",data:{schedules:e,_token:token},success:function(e){$("button").attr("disabled","disabled"),$("input").attr("disabled","disabled"),$("#manageschedulepanel").css("background-color","#d6e9c6")},error:function(e,t,a){}})}),$("#search_patientdental").keyup(function(){$("#searchlistofallpatientsdental").hide(),$("#searchTabledental").hide(),$("#searchloadingdental").show();var e=$("#search_patientdental").val();$.post("/searchpatientnamerecorddental",{search_string:e},function(e){if($("#searchResultsdental").html(""),e.counter>0){output="";for(var t=0;t<e.searchpatientidarray.length;t++)output+="<tr><td><a class='searchQueryResultsDental' id='resultId_"+e.searchpatientidarray[t]+"'>"+e.searchpatientlastnamearray[t]+", "+e.searchpatientfirstnamearray[t]+"</a></td></tr>";$("#searchloadingdental").hide(),$("#searchResultsdental").html(output),$("#searchTabledental").show(),$(".searchQueryResultsDental").click(function(){var e=$(this).attr("id").split("_")[1];$.post("/displaypatientrecordsearchdental",{patient_id:e},function(t){output="",$("#ageTd").html(t.patient_info.age),"F"==t.patient_info.sex?$("#sexTd").html("Female"):$("#sexTd").html("Male"),1==t.patient_info.display_course_and_year_level?($("#courseTd").html(t.patient_info.degree_program_description),$("#yearlevelTd").html(t.patient_info.year_level),$("#courseRow").show(),$("#yearlevelRow").show()):($("#courseTd").html(""),$("#yearlevelTd").html(""),$("#courseRow").hide(),$("#yearlevelRow").hide()),$("#birthdateTd").html(t.patient_info.birthday),$("#religionTd").html(t.patient_info.religion),$("#nationalityTd").html(t.patient_info.nationality),$("#fatherTd").html(t.patient_info.father_first_name+" "+t.patient_info.father_last_name),$("#motherTd").html(t.patient_info.mother_first_name+" "+t.patient_info.mother_last_name),$("#homeaddressTd").html(t.patient_info.street+", "+t.patient_info.town+", "+t.patient_info.province),$("#restelTd").html(t.patient_info.residence_telephone_number),$("#personalcontactnumberTd").html(t.patient_info.personal_contact_number),$("#guardiannameTd").html(t.patient_info.guardian_first_name+" "+t.patient_info.guardian_last_name),$("#guardianaddressTd").html(t.patient_info.guardian_street+", "+t.patient_info.guardian_town+", "+t.patient_info.guardian_province),$("#guardianrelationshipTd").html(t.patient_info.relationship),$("#guardiantelTd").html(t.patient_info.guardian_tel_number),$("#guardiancpTd").html(t.patient_info.guardian_cellphone),$("#illnessesTd").html(t.patient_info.illness),$("#operationTd").html(t.patient_info.operation),$("#allergiesTd").html(t.patient_info.allergies),$("#famhistoryTd").html(t.patient_info.family),$("#maintenanceTd").html(t.patient_info.maintenance_medication),$("#patientInfoModalFooter").html('<a href="/dentist/viewrecords/'+e+'" class="btn btn-info" role="button" id=viewrecordsfromsearchdental>View Records</a>'),t.patient_info.picture?$("#searchPatientRecordInfoImg").attr("src","/images/"+t.patient_info.picture):$("#searchPatientRecordInfoImg").attr("src","/images/blankprofpic.png"),$("#searchPatientRecordInfoDental").modal(),$("#addnewrecordfromsearch").click(function(){$("#searchPatientRecordInfoDental").modal("hide")}),$("#viewrecordsfromsearch").click(function(){$("#searchPatientRecordInfoDental").modal("hide")})})})}else"blankstring"==e.counter?($("#searchloadingdental").hide(),$("#searchTabledental").hide(),$("#searchResultsdental").html(""),$("#searchlistofallpatientsdental").show()):($("#searchloadingdental").hide(),$("#searchlistofallpatientsdental").hide(),$("#searchTabledental").show(),$("#searchResultsdental").html("<tr><td>No results found.</td></tr>"))})}),$(".listofallpatientsdental").click(function(){var e=$(this).attr("id").split("_")[1];$.post("/displaypatientrecordsearchdental",{patient_id:e},function(t){output="",$("#ageTd").html(t.patient_info.age),"F"==t.patient_info.sex?$("#sexTd").html("Female"):$("#sexTd").html("Male"),1==t.patient_info.display_course_and_year_level?($("#courseTd").html(t.patient_info.degree_program_description),$("#yearlevelTd").html(t.patient_info.year_level),$("#courseRow").show(),$("#yearlevelRow").show()):($("#courseTd").html(""),$("#yearlevelTd").html(""),$("#courseRow").hide(),$("#yearlevelRow").hide()),$("#birthdateTd").html(t.patient_info.birthday),$("#religionTd").html(t.patient_info.religion),$("#nationalityTd").html(t.patient_info.nationality),$("#fatherTd").html(t.patient_info.father_first_name+" "+t.patient_info.father_last_name),$("#motherTd").html(t.patient_info.mother_first_name+" "+t.patient_info.mother_last_name),$("#homeaddressTd").html(t.patient_info.street+", "+t.patient_info.town+", "+t.patient_info.province),$("#restelTd").html(t.patient_info.residence_telephone_number),$("#personalcontactnumberTd").html(t.patient_info.personal_contact_number),$("#guardiannameTd").html(t.patient_info.guardian_first_name+" "+t.patient_info.guardian_last_name),$("#guardianaddressTd").html(t.patient_info.guardian_street+", "+t.patient_info.guardian_town+", "+t.patient_info.guardian_province),$("#guardianrelationshipTd").html(t.patient_info.relationship),$("#guardiantelTd").html(t.patient_info.guardian_tel_number),$("#guardiancpTd").html(t.patient_info.guardian_cellphone),$("#illnessesTd").html(t.patient_info.illness),$("#operationTd").html(t.patient_info.operation),$("#allergiesTd").html(t.patient_info.allergies),$("#famhistoryTd").html(t.patient_info.family),$("#maintenanceTd").html(t.patient_info.maintenance_medication),$("#patientInfoModalFooter").html('<a href="/dentist/viewrecords/'+e+'" class="btn btn-info" role="button" id=viewrecordsfromsearchdental>View Records</a>'),t.patient_info.picture?$("#searchPatientRecordInfoImg").attr("src","/images/"+t.patient_info.picture):$("#searchPatientRecordInfoImg").attr("src","/images/blankprofpic.png"),$("#searchPatientRecordInfoDental").modal(),$("#viewrecordsfromsearchdental").click(function(){$("#searchPatientRecordInfoDental").modal("hide")})})}),$("#search_month").change(function(){var e=$(this).find(":selected")[0].value;if($("#search_date").html(""),$("#search_date").removeAttr("disabled"),$("#search_date").append('<option value="00" selected></option>'),0==e&&$("#search_date").attr("disabled","disabled"),1==e||3==e||5==e||7==e||8==e||10==e||12==e)for(var a=1;32>a;a++)$("#search_date").append('<option value="'+a+'">'+a+"</option>");else if(2==e)if(t($("#search_year").find(":selected")[0].value))for(var a=1;30>a;a++)$("#search_date").append('<option value="'+a+'">'+a+"</option>");else for(var a=1;29>a;a++)$("#search_date").append('<option value="'+a+'">'+a+"</option>");else if(4==e||6==e||9==e||11==e)for(var a=1;31>a;a++)$("#search_date").append('<option value="'+a+'">'+a+"</option>")}),$("#search_year").change(function(){var e=$(this).find(":selected")[0].value,a=$("#search_month").find(":selected")[0].value;if(1==t(e)&&2==a){$("#search_date").html(""),$("#search_date").append('<option value="00" selected></option>');for(var n=1;30>n;n++)$("#search_date").append('<option value="'+n+'">'+n+"</option>")}if(0==t(e)&&2==a){$("#search_date").html(""),$("#search_date").append('<option value="00" selected></option>');for(var n=1;29>n;n++)$("#search_date").append('<option value="'+n+'">'+n+"</option>")}}),$("#searchbydatebuttondental").click(function(){$("#searchlistofallpatients").hide(),$("#searchTable").hide(),$("#searchloading").show(),$.post("/searchpatientbydaterecorddental",{search_month:$("#search_month").find(":selected")[0].value,search_date:$("#search_date").find(":selected")[0].value,search_year:$("#search_year").find(":selected")[0].value},function(e){if($("#searchResults").html(""),e.counter>0){output="";for(var t=0;t<e.searchpatientappointmentidyarray.length;t++)output+="<tr><td>"+e.searchpatientscheduledayarray[t]+"</td><td>"+e.searchpatientscheduletimearray[t]+"</td><td><a class='searchQueryResults' href='/dentist/viewdentalrecord/"+e.searchpatientappointmentidyarray[t]+"/' dentalrecorddate' id='dentalrecorddate_"+e.searchpatientappointmentidyarray[t]+"'>"+e.searchpatientnamearray[t]+"</a></td></tr>";$("#searchlistofallpatients").hide(),$("#searchloading").hide(),$("#searchResults").html(output),$("#searchTable").show(),$(".dentalrecorddate").click(function(){var e=$(this).attr("id").split("_")[1];$.post("/viewindividualrecordfromsearchdental",{dental_appointment_id:e},function(e,t,a){$("#viewDentalRecordBasedOnDateModal").modal()})})}else"blankstring"==e.counter?($("#searchloading").hide(),$("#searchTable").hide(),$("#searchResults").html(""),$("#searchlistofallpatients").show()):($("#searchloading").hide(),$("#searchlistofallpatients").hide(),$("#searchTable").show(),$("#searchResults").html("<tr><td>No results found.</td></tr>"))})})});